<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="app.css" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Medicine Retrieve</title>
    </head>
    <body>
        <div class="insert-main-container">
            <div class="insert-container">
                <input type="text" placeholder="Name" id="name" class="input" />
                <input type="text" placeholder="Species" id="species" class="input" />
                <div class="form-btn-container">
                    <button class="btn secondary" onclick="location.href='../index.html'">Back</button>
                    <button id="submit" class="btn primary">Submit</button>
                </div>
            </div>
        </div>

        <script>
            document.getElementById('submit').addEventListener('click', function (event) {
                event.preventDefault() // Prevent the default form submission

                let valid = true
                const inputs = document.querySelectorAll('input')
                inputs.forEach((input) => {
                    if (input.value.trim() === '') {
                        valid = false
                    }
                })

                if (!valid) {
                    alert('Please fill out all the fields.')
                    return
                }

                const name = document.getElementById('name').value.trim()
                const species = document.getElementById('species').value.trim()

                fetch(`http://localhost:3000/medicine?name=${name}&species=${species}`)
                    .then((response) => response.json())
                    .then((data) => {
                        if (data.length === 0) {
                            alert('No data found.')
                            return
                        }

                        const queryParams = new URLSearchParams()
                        queryParams.append('name', name)
                        queryParams.append('species', species)

                        window.location.href = `display.html?${queryParams.toString()}`
                    })
                    .catch((error) => {
                        console.error('Error:', error)
                        alert('Error retrieving data')
                    })
            })
        </script>
    </body>
</html>
